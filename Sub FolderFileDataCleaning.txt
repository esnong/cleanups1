Sub CreatePowerBISheet()
    Dim wsSource As Worksheet
    Dim wsDest As Worksheet
    Dim lastRow As Long
    Dim destRow As Long
    Dim i As Long, j As Long
    Dim yearOffset As Integer
    Dim assetType As String, assetDesc As String
    Dim amount As Double
    Dim colMap As Variant
    
    ' Define source worksheet
    Set wsSource = ThisWorkbook.Sheets(1) ' Change as needed (e.g., "Data")
    
    ' Delete "For PowerBI" if it exists
    Application.DisplayAlerts = False
    On Error Resume Next
    ThisWorkbook.Sheets("For PowerBI").Delete
    On Error GoTo 0
    Application.DisplayAlerts = True
    
    ' Create new "For PowerBI" worksheet
    Set wsDest = ThisWorkbook.Sheets.Add
    wsDest.Name = "For PowerBI"
    
    ' Add headers
    With wsDest
        .Cells(1, 1).Value = "Asset Type"
        .Cells(1, 2).Value = "Asset Description"
        .Cells(1, 3).Value = "Amount"
        .Cells(1, 4).Value = "Year"
    End With
    
    ' Determine last data row in source
    lastRow = wsSource.Cells(wsSource.Rows.Count, "F").End(xlUp).Row
    destRow = 2 ' Start writing from second row
    
    ' Map column letters M to R to years 2022 to 2027
    colMap = Array(13, 14, 15, 16, 17, 18) ' M = 13 to R = 18
    
    ' Loop through each row in source sheet
    For i = 2 To lastRow
        assetType = wsSource.Cells(i, 6).Value ' Column F
        assetDesc = wsSource.Cells(i, 7).Value ' Column G
        
        If assetType = "GFA: Buildings" Or assetType = "GFA: MT&E" Then
            For j = 0 To 5 ' Columns M to R (2022 to 2027)
                amount = wsSource.Cells(i, colMap(j)).Value
                If amount <> 0 And amount <> "" Then
                    wsDest.Cells(destRow, 1).Value = IIf(assetType = "GFA: Buildings", "Buildings", "Equipment")
                    wsDest.Cells(destRow, 2).Value = assetDesc
                    wsDest.Cells(destRow, 3).Value = amount
                    wsDest.Cells(destRow, 4).Value = 2022 + j
                    destRow = destRow + 1
                End If
            Next j
        End If
    Next i
End Sub
