Sub AppendFiles()

    Dim SourceFolder As String
    Dim DestinationFolder As String
    Dim SourceFile As String
    Dim DestinationFile As String
    Dim SourceWB As Workbook
    Dim DestinationWB As Workbook
    Dim SourceWS As Worksheet
    Dim DestinationWS As Worksheet
    Dim LastRowSource As Long
    Dim LastRowDestination As Long
    Dim CostCentre As String
    Dim SourceFileName As String
    Dim DestFileName As String
    Dim RowCount As Long

    ' Set Source and Destination Folder paths
    SourceFolder = "C:\Your\Source\Folder\Path\" ' Change this to your source folder path
    DestinationFolder = "C:\Your\Destination\Folder\Path\" ' Change this to your destination folder path

    ' Loop through all files in the Source Folder
    SourceFile = Dir(SourceFolder & "*.xls*")
    
    Do While SourceFile <> ""

        ' Extract the cost center value from the source file name (e.g. "jun_524000_2025")
        CostCentre = Split(Split(SourceFile, "_")(1), ".")(0)

        ' Find the corresponding Destination file
        DestinationFile = Dir(DestinationFolder & CostCentre & "*.xls*")
        
        If DestinationFile <> "" Then
            ' Open the Source and Destination Workbooks
            Set SourceWB = Workbooks.Open(SourceFolder & SourceFile)
            Set DestinationWB = Workbooks.Open(DestinationFolder & DestinationFile)
            
            ' Assuming the first sheet in both source and destination workbooks
            Set SourceWS = SourceWB.Sheets(1)
            Set DestinationWS = DestinationWB.Sheets(1)

            ' Find the last row of data in the Source and Destination sheets
            LastRowSource = SourceWS.Cells(SourceWS.Rows.Count, 1).End(xlUp).Row
            LastRowDestination = DestinationWS.Cells(DestinationWS.Rows.Count, 1).End(xlUp).Row
            
            ' Loop through each row in the Source sheet, starting from row 2 to skip the header
            For RowCount = 2 To LastRowSource
                ' Append the row of data from the Source to the Destination sheet
                DestinationWS.Rows(LastRowDestination + 1).Value = SourceWS.Rows(RowCount).Value
                LastRowDestination = LastRowDestination + 1
            Next RowCount

            ' Save and close both workbooks
            DestinationWB.Save
            DestinationWB.Close
            SourceWB.Close False
        End If

        ' Get the next Source file
        SourceFile = Dir

    Loop
    
    MsgBox "Appending completed successfully!"

End Sub
