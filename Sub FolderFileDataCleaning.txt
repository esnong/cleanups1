Sub ProcessCSVFiles()

    Dim folderPath As String
    Dim fileName As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    ' Prompt user to select a folder
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Select Folder Containing CSV Files"
        If .Show <> -1 Then Exit Sub
        folderPath = .SelectedItems(1) & "\"
    End With

    ' Find all .csv files in folder
    fileName = Dir(folderPath & "*.csv")

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Do While fileName <> ""
        ' Open the CSV file as text to avoid Excel auto-formatting
        Workbooks.OpenText Filename:=folderPath & fileName, _
            DataType:=xlDelimited, _
            Other:=True, OtherChar:="|", _
            FieldInfo:=Array(1, 1)

        Set wb = ActiveWorkbook
        Set ws = wb.Sheets(1)

        ' Optional: Save as proper Excel format (you can comment this out if not needed)
        ' wb.SaveAs Filename:=Replace(wb.FullName, ".csv", "_converted.xlsx"), FileFormat:=xlOpenXMLWorkbook

        ' Save the cleaned-up CSV
        wb.SaveAs Filename:=wb.Path & "\" & wb.Name, FileFormat:=xlCSV

        wb.Close SaveChanges:=True

        fileName = Dir  ' Move to next file
    Loop

    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

    MsgBox "All CSV files have been processed.", vbInformation

End Sub
