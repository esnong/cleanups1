Sub AddMonthColumn()
    Dim ws As Worksheet
    Dim lastColumn As Long
    Dim userInput As String
    Dim headerName As String
    Dim rowNum As Long
    Dim formulaColumn As Long
    Dim cell As Range

    ' Set the worksheet reference
    Set ws = ThisWorkbook.Sheets("Table")
    
    ' Ask for user input (MMM-YY format)
    userInput = InputBox("Please enter the month and year (e.g., Jan-25):")
    
    ' If no input is provided, exit the sub
    If userInput = "" Then
        MsgBox "No input provided. Macro will exit."
        Exit Sub
    End If
    
    ' Get the last column in the Table sheet
    lastColumn = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    
    ' Determine the second last column (where the new column will go)
    formulaColumn = lastColumn - 1
    
    ' Insert a new column as the second last column
    ws.Columns(formulaColumn).Insert Shift:=xlToRight
    
    ' Set the header of the new column to the user input
    ws.Cells(1, formulaColumn).Value = userInput
    
    ' Copy the formula from the third last column (column before last) to the new column
    ws.Range(ws.Cells(2, formulaColumn + 1), ws.Cells(ws.Rows.Count, formulaColumn + 1).End(xlUp)).Copy
    ws.Cells(2, formulaColumn).PasteSpecial Paste:=xlPasteFormulas
    
    ' Convert the third last column formulas to values
    For Each cell In ws.Range(ws.Cells(2, formulaColumn + 1), ws.Cells(ws.Rows.Count, formulaColumn + 1).End(xlUp))
        If cell.HasFormula Then
            cell.Value = cell.Value
        End If
    Next cell

    ' Optional: Clean up any selection or clipboard activity
    Application.CutCopyMode = False

    ' Notify the user that the task is completed
    MsgBox "The new column has been added and the formulas have been converted."
End Sub
