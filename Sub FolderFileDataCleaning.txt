Sub FormatCSV_ProperlyIntoColumns()
    Dim folderPath As String
    Dim fileName As String
    Dim fullPath As String
    Dim lineText As String
    Dim lineParts() As String
    Dim rowNum As Long, colNum As Long
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim fDialog As FileDialog

    ' Let user select folder
    Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)
    If fDialog.Show <> -1 Then Exit Sub
    folderPath = fDialog.SelectedItems(1) & "\"

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    ' Loop through each .csv file
    fileName = Dir(folderPath & "*.csv")
    Do While fileName <> ""
        fullPath = folderPath & fileName

        ' Open a new workbook and insert a worksheet
        Set wb = Workbooks.Add
        Set ws = wb.Sheets(1)

        ' Open original CSV file for reading
        Open fullPath For Input As #1
        rowNum = 1
        Do While Not EOF(1)
            Line Input #1, lineText
            lineParts = Split(lineText, "|") ' split using pipe
            For colNum = 0 To UBound(lineParts)
                ws.Cells(rowNum, colNum + 1).Value = Trim(lineParts(colNum))
            Next colNum
            rowNum = rowNum + 1
        Loop
        Close #1

        ' Save the workbook as CSV, overwriting the original file
        wb.SaveAs Filename:=fullPath, FileFormat:=xlCSV
        wb.Close SaveChanges:=False

        fileName = Dir ' Move to next file
    Loop

    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

    MsgBox "All CSV files formatted correctly into rows and columns!"
End Sub
